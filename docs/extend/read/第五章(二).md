# 第五章(二)

## 高可用的应用

应用层主要处理网站应用的业务逻辑,因此又是也称为业务逻辑层,应用的一个显著特点是应用的无状态性.

### 通过负载均衡进行无状态服务的失效转移

不保存状态的应用给高可用的架构设计带来了巨大便利,既然入伍前不保存请求状态,那么多所有的服务器都是相同的,当任意一台或多态服务器宕机,请求提交给集群中其他任意一台可用的机器处理,对终端用户而言,都是可用的.

负载均衡,:主要使用在业务量和数据量较高的情况下,当单台服务器不足以承担所有负载时,用过负载均衡手段,将流量和数据分摊到一个集群组成的多台服务器中,以提高整体的负载处理能力.

### 应用服务器集群的 Session 管理

由于每台服务器个体都是单独完成业务,关于状态管理,也就有以下手段:

#### Session 复制

这是在早期企业系统使用较多的一种服务器集群的 Session 管理机制.引用服务器开启 web 容器的 Session 复制功能,在集群中的几台服务器之间同步 Session 对象,使得每台服务器上都保存所有用户的 Session 信息.

#### Session 绑定

利用复制均衡的源地址 Hash 算法实现,负载均横服务器总是将原来源于同一 IP 的请求分发到同一服务器上,

#### 利用 cookie 记录 Session

早期的企业应用系统使用的 C/架构,一种管理 Session 的方式是将 Session 记录在客户端,每次请求服务器时,将 Session 放在请求中发送给服务器,服务器处理完请求后再将修改后的 Session 响应给客户端.

#### Session 服务器

那么有没有可用性高,伸缩性好,性能也不错,对信息大小没有限制的服务器集群 Session 管理方法?这就是.!

利用独立部署的 Session 服务器(集群)同一管理 Session,应用服务器每次读写 Session 时,都访问 Session 服务器.

## 高可用服务

#### 分解管理

在服务部署上也进行必要的隔离,避免故障的连锁反应.

#### 超时设置

由于服务器宕机,线程死锁等原因,可能导致程序对服务端的调用失去响应,进而导致用户请求长时间得不到响应.同时还占用资源,不利于及时访问请求转移大正常的服务器上

#### 异步调用

异步列队完成.避免一个服务失败导致整个应用请求失败情况;采取异步,一步一列队.

#### 服务降级

在网站的高峰期,服务可能因为大量的并发导致性能下降,严重时肯能导致宕机.保证正常运行,应对服务器降级.:拒绝服务和关闭服务

**拒绝服务:**拒绝低优先级的应用调用,减少服务器的调用次数.

**关闭服务:**关不不重要的服务,或服务内部关闭不重要的功能.

#### 幂等性设计
